@model IEnumerable<MutluSepet.Models.Product>
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h2 class="mb-3">@ViewData["Title"]</h2>

<div class="d-flex justify-content-end mb-3">
    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addProductModal">
        Yeni Ürün Ekle
    </button>
</div>

<div class="row row-cols-1 row-cols-md-3 g-4">
@foreach(var item in Model)
{
    <div class="col">
        <div class="card h-100">
            <img src="@item.ImageUrl" class="card-img-top" style="height:200px; object-fit:cover;" />
            <div class="card-body d-flex flex-column">
                <h5 class="card-title">@item.Name</h5>
                <p class="card-text">@item.Description</p>
                <p class="fw-bold text-success">@item.Price.ToString("C")</p>
                <p>Stok: @item.Stock</p>
                <p>Kategori: @item.Category?.Name</p>

                <div class="mt-auto d-flex justify-content-between">
                    <a class="btn btn-danger btn-sm" asp-action="DeleteProduct" asp-route-id="@item.Id">Sil</a>
                    <a class="btn btn-primary btn-sm" asp-controller="Product" asp-action="Details" asp-route-id="@item.Id">Detay</a>
                </div>
            </div>
        </div>
    </div>
}
</div>

<!-- Modal: Yeni Ürün Ekleme -->
<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addProductLabel">Yeni Ürün Ekle</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form asp-action="AddProduct" asp-controller="Admin" method="post">
            @Html.AntiForgeryToken()

            <div class="mb-3">
                <label class="form-label">Ürün Adı</label>
                <input asp-for="First().Name" class="form-control" required />
            </div>

            <div class="mb-3">
                <label class="form-label">Açıklama</label>
                <textarea asp-for="First().Description" class="form-control" rows="3"></textarea>
            </div>

            <div class="mb-3">
                <label class="form-label">Fiyat</label>
                <input asp-for="First().Price" type="number" step="0.01" class="form-control" required />
            </div>

            <div class="mb-3">
                <label class="form-label">Stok</label>
                <input asp-for="First().Stock" type="number" class="form-control" required />
            </div>

            <div class="mb-3">
                <label class="form-label">Kategori</label>
                <select asp-for="First().CategoryId" class="form-select" required>
                    <option value="">Seçiniz...</option>
                    @foreach(var cat in (List<MutluSepet.Models.Category>)ViewBag.Categories)
                    {
                        <option value="@cat.Id">@cat.Name</option>
                    }
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Resim URL</label>
                <input asp-for="First().ImageUrl" class="form-control" placeholder="/images/urun.jpg" />
            </div>

            <div class="text-end">
                <button type="submit" class="btn btn-success">Ekle</button>
            </div>
        </form>
      </div>
    </div>
  </div>
</div>
